<h2 mat-dialog-title>Add Storage Server</h2>
<app-message [message$]="message$"></app-message>
<form [formGroup]="addFormGroup" (ngSubmit)="onSubmit(addFormGroup.value)">
    <mat-dialog-content>
        <mat-form-field>
            <mat-label>Server Address (Ip or Hostname)</mat-label>
            <input matInput type="text" formControlName="address">
            <a mat-button *ngIf="!address.invalid" matSuffix 
            mat-icon-button
            matTooltip="Check Connectivity"
            aria-label="Check Connectivity"
            [disabled]="checkingConnectivity"
            (click)="onConnectivityCheck()">
                <mat-icon>network_check</mat-icon>
            </a>
            <mat-error *ngIf="address.invalid && !address.hasError('itemExists')">The server address must be a valid and secure (https) Ip or host name</mat-error>
            <mat-error *ngIf="address.hasError('itemExists')">A server with the same address already exists.</mat-error>
        </mat-form-field>
        <div *ngIf="checkingConnectivity" fxLayout="row wrap" fxLayoutAlign="center center">
            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
        </div>
        <mat-form-field appearance="fill">
            <mat-label>Select server state</mat-label>
            <mat-select [formControl]="optionControl" [disabled]="!addressReachable" required>
                <mat-option *ngFor="let option of serverOptions" [value]="option">
                    {{option.name}}
                </mat-option>
            </mat-select>
            <mat-hint>{{optionControl.value.hint}}</mat-hint>
          </mat-form-field>

    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <button mat-button mat-dialog-close>Cancel</button>
        <button
            mat-button color="accent"
            [disabled]="!addFormGroup.valid || isBusy" type="submit"
            >Add Server
        </button>
    </mat-dialog-actions>
</form>
